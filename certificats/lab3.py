capcelera1 = "marta.garcia@uab.cat%Estudiant%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAlw1l/iuC4c9NEloKbyG2A8NexmqfAr/y38H2tWoWMaS42Hzonlx6UaCVK7lNm6xpMVsMKrPO5Yhv/45dJH4a8Dt+9GYmi0vJRlvgZp7v70usYV5j11Dht06XwReXgZ/Cor78sH5XLikb7P+vN43xbGZCb7ZmZKP3GzMzNipLy8dlHFfnEPrHmr8bS5hKAdp3eRUkatCSwWc=%"
capcelera2="marta.garcia@uab.cat%Estudiant%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAlw1l/iuC4c9NEloKbyG2A8NexmqfAr/y38H2tWoWMaS42Hzonlx6UaCVK7lNm6xpMVsMKrPO5Yhv/45dJH4a8Dt+9GYmi0vJRlvgZp7v70usYV5j11Dht06XwReXgZ/Cor78sH5XLikb7P+vN43xbGZCb7ZmZKP3GzMzNipLy8dlHFfnEPrHmr8bS5hKAdp3eRUkatCSwWc=%CA-UAB%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAlw0VcSQVWZhgYMvGqLjueutYCIX2YxWrtH1YO3JdDVEObclxIbKfX1YfXJ6N4QVYMUAxb+/0TXTrDSF13YE2kA2SqJ6si1LrrCPm4dbYgsrOLCvKfuYwtiICsFdjwpgixQ/kJQMAInNil/psK7MxvSS7Dfv8T88+49yYujMIrj6VN9O5Huc5baCPZRC8x6q/OGc55RlO/80=%24/10/2026 19:49:54%AtaT75/SI00k9/kohe0rYoGUcHRBW7JVywNHhsg4AvAqhGv3JDhHUXnP8CXB8u0HG+UtfVpHF57jVDl8pGYh9tYAHvH/7N/rBHqzv5FH0l0oybB5BBOoZWQCwAwGDCTL2mUx8Vmx8gI3Y9lpqAknwcNxhgmoA5tw3/h5i8HDgU6am8y40+keOoC0lGjvMVgIPvbAc6TIog=="


capcelerabusi = "Arnau.BusquetsD@autonoma.cat%alumne%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDBh03TNOYQzyE6FgGn6gIdh1WBUsXax2kz57KvM7joCOASQJd8fo3Uc848i6ulQ8buvCbeEIzJtxo0WJNOPdQpMNQ9KzRwA0Q3wYdqlw35EZaXQ3oLBWA6iY40t56JZBiKMN7/v+BSLqs886a/tGZzHfzKtdaFpn8+PtZLrHnIWQ==%CA-UAB%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAlw0VcSQVWZhgYMvGqLjueutYCIX2YxWrtH1YO3JdDVEObclxIbKfX1YfXJ6N4QVYMUAxb+/0TXTrDSF13YE2kA2SqJ6si1LrrCPm4dbYgsrOLCvKfuYwtiICsFdjwpgixQ/kJQMAInNil/psK7MxvSS7Dfv8T88+49yYujMIrj6VN9O5Huc5baCPZRC8x6q/OGc55RlO/80=%22/05/2027%CMsKukGpLHBk016Udw47x7TuJAFdAgtpL8l+MLtzSinSQ0k3gl7zlyP3/K6K/j8ynLAbZsitnPi7rCYu8E3ho4hc6LVTLV+4ae4TsDAqvEl2jXn13ET7aD4wFa30lPTydiX+ScfDGqFnoTAAgPrqkelfH9kVf150TyxoC1dpyKgWKs8RyQBQ361tcwpgS7bmfRHweyduyw==" 
certificatprofe = "carlos.borrego@uab.cat%profesor%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDBh03TNOYQzyE6FgGn6gIdh1WBUsXax2kz57KvM7joCOASQJd8fo3Uc848i6ulQ8buvCbeEIzJtxo0WJNOPdQpMNQ9KzRwA0Q3wYdqlw35EZaXQ3oLBWA6iY40t56JZBiKMN7/v+BSLqs886a/tGZzHfzKtdaFpn8+PtZLrHnIWQ==%"
certificatdavid = "David.MartiF@autonoma.cat%alumne%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDDEwVoZIUwNK9NWfDrF24xfOFGCJvuDJYkDcS/7BXYtK5Y4rESFcmn7CSZmXoRpwf6FYR4w24d0ua8P5cc5gQ4MHwZuARa8D048BA9ejcQfrVNTUFF9BXcM+UnlktkG8CN88f/xgxDoz/9aZPvS6u+L5fU14OCHMVQtStAh993vw==%CA-UAB%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAlw0VcSQVWZhgYMvGqLjueutYCIX2YxWrtH1YO3JdDVEObclxIbKfX1YfXJ6N4QVYMUAxb+/0TXTrDSF13YE2kA2SqJ6si1LrrCPm4dbYgsrOLCvKfuYwtiICsFdjwpgixQ/kJQMAInNil/psK7MxvSS7Dfv8T88+49yYujMIrj6VN9O5Huc5baCPZRC8x6q/OGc55RlO/80=%11/06/2027%B3IjwOIe05ugzTyOE1+51wqWNIX50wANj2SZveXBnl4YAcAT2c3PTiRcHmx9msTPKK2mw7Cd0hsdOX1o+pVOlczKNc8sTIja5A8W+pv1X3G7+S3P/3YjreyHM369V+29GGX8Nj4ZZGBVUpVAPW3CEr7b4BSSGiLrOzCtWdLCaQtZXFuDLiRY0qbBFdNN1SSvFaU08nVCGw=="

certificatdavid2= "David.MartiF@autonoma.cat%alumne%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDCDqUezfYL9n7zPg6j98nozhW7HilmrEWJxPQz4nU8jllL2m1k4RsGOJMBEErBXzm+KvgbFUVg5Zn0esOxBO9aUMngOzuanQYaHNcjTLXJE14mlcYcnSUwOP9j801Nr4aZ6dTmq2qs2XntYicumYHdrYyOHgKdz7ZPcgJEBQrgjw==%CA-UAB%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAlw0VcSQVWZhgYMvGqLjueutYCIX2YxWrtH1YO3JdDVEObclxIbKfX1YfXJ6N4QVYMUAxb+/0TXTrDSF13YE2kA2SqJ6si1LrrCPm4dbYgsrOLCvKfuYwtiICsFdjwpgixQ/kJQMAInNil/psK7MxvSS7Dfv8T88+49yYujMIrj6VN9O5Huc5baCPZRC8x6q/OGc55RlO/80=%11/06/2027%BOTugSdynlqPa982o8zQASpuPbCUUC1ElYa3ORnK5bsvWweLA3XAvAs6NNpijfnK86Ojb+316jtdi0nHEzCOlS65YTnz6xa+tJMIhlgaXZXR/ICNx9+muX1K28C6VLnhpLivTdDALWI4IjHBU7yCbkANuxKkQef6UEqbgtOutdaByXlisX2E+eVTfzQj1GR57vlmHj085w=="
from Crypto.PublicKey import RSA
from Crypto.Signature import PKCS1_v1_5
from Crypto.Hash import SHA256
from base64 import b64encode, b64decode
from sign_message import PrunedSHA256Hash, PRUNED_HASH_SIZE, RSA_KEY_SIZE




# Hash the message to sign
 
h = PrunedSHA256Hash().new(certificatprofe.encode('utf-8'))
print(h.hexdigest())

# Try to get a certificate with my name with the same hash

for i in range(100000000):
    prehash = 'David.MartiF@autonoma.cat%'
    posthash = '%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDCDqUezfYL9n7zPg6j98nozhW7HilmrEWJxPQz4nU8jllL2m1k4RsGOJMBEErBXzm+KvgbFUVg5Zn0esOxBO9aUMngOzuanQYaHNcjTLXJE14mlcYcnSUwOP9j801Nr4aZ6dTmq2qs2XntYicumYHdrYyOHgKdz7ZPcgJEBQrgjw==%CA-UAB%ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAlw0VcSQVWZhgYMvGqLjueutYCIX2YxWrtH1YO3JdDVEObclxIbKfX1YfXJ6N4QVYMUAxb+/0TXTrDSF13YE2kA2SqJ6si1LrrCPm4dbYgsrOLCvKfuYwtiICsFdjwpgixQ/kJQMAInNil/psK7MxvSS7Dfv8T88+49yYujMIrj6VN9O5Huc5baCPZRC8x6q/OGc55RlO/80=%11/06/2027%BOTugSdynlqPa982o8zQASpuPbCUUC1ElYa3ORnK5bsvWweLA3XAvAs6NNpijfnK86Ojb+316jtdi0nHEzCOlS65YTnz6xa+tJMIhlgaXZXR/ICNx9+muX1K28C6VLnhpLivTdDALWI4IjHBU7yCbkANuxKkQef6UEqbgtOutdaByXlisX2E+eVTfzQj1GR57vlmHj085w=='
    hash = PrunedSHA256Hash().new((prehash + str(i) + posthash).encode('utf-8'))
    if hash.hexdigest() == h.hexdigest():
        print("i: ", i)
        print("hash:", hash.hexdigest())
        print("certificat:", prehash + str(i) + posthash)
        break

    # pri